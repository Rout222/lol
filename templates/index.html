
<!DOCTYPE html>
<head>
  <title>League of Legends Statics</title>
<meta charset="utf-8">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css.css') }}">
</head>
<body>
<div class="container">
        <div class="row">
            {{teste}}
            <div class="col-lg-8">
                <form id="convFilter" class="form-horizontal" action="/" method="POST">
                <div class="col-md-6">
                    <div class="form-group">
                      <label class="col-sm-4 control-label" for="min">Número Mínimo de partidas</label>
                      <div class="col-sm-8">
                        <input type="number" class="form-control" name="min" id="min" placeholder="min">
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="col-sm-4 control-label" for="max">Número Máximo de partidas</label>
                       <div class="col-sm-8">
                      <input type="number" class="form-control" name="max" id="max" placeholder="max">
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="col-sm-4 control-label" for="win">Minimo de % de vitória</label>
                      <div class="col-sm-8">
                        <input type="number" step="0.01" class="form-control" name="win" id="win" placeholder="0 a 1">
                      </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group ">
                      <label class="col-sm-4 control-label" for="bans">Bans</label>
                      <div class="col-sm-8">
                        <select multiple class="form-control" form="convFilter" name="bans" id="bans"> 
                          {% for champ in champs %}
                            <option value="{{champ[0]}}">{{champ[1][1]}}</option> 
                          {% endfor %}
                        </select>
                      </div>
                    </div>
                    <div class="form-group ">
                      <label class="col-sm-4 control-label" for="picks">Picks</label>
                      <div class="col-sm-8">
                        <select multiple class="form-control" form="convFilter" name="picks" id="picks"> 
                          {% for champ in champs %}
                            <option value="{{champ[0]}}" selected="selected">{{champ[1][1]}}</option> 
                          {% endfor %}
                        </select>
                      </div>
                    </div>
                    <div class="col-sm-offset-4 col-sm-8">
                    <button type="button" id="find-all" class="btn btn-primary">Find All</button>
                    <button type="submit" class="btn btn-primary">Search</button>
                    </div>
              </div>
                  
              </form>
            </div>
        </div>
</div>
<div class="container">
<div class="row">
  <div class="col-md-2">
    <div id='notes'></div>
  </div>
  <div class="col-md-10">
    <svg width="800" height="780"></svg>
  </div>
</div>
</div>

<script src="http://d3js.org/d3.v4.min.js"></script>
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script>
var graph = {{ value }};
var svg = d3.select("svg"),
    width = +svg.attr("width"),
    height = +svg.attr("height");
var linkDistance = Math.min(width,height)/4;

var simulation = d3.forceSimulation()
    .force("charge", d3.forceManyBody().strength(-200))
    .force("link", d3.forceLink().id(function(d) { return d.id; }).distance(
    function(d) { return linkDistance+(d.value*d.win); }
    ))
    .force("x", d3.forceX(width / 2))
    .force("y", d3.forceY(height / 2))
    .on("tick", ticked);

var link = svg.selectAll(".link"),
    node = svg.selectAll(".node");
  simulation.nodes(graph.nodes);
  simulation.force("link").links(graph.links);
  link = link
    .data(graph.links)
    .enter().append("line")
      .attr("stroke-width", function(d) { 
        if(d.win > 0.7){return (d.win * 10); }
        if(d.win > 0.5){return (d.win * 7); }
        return (d.win * 5); 

      })
      .attr("class", function(d) { 
        if (d.win > 0.7) {return "linkStrong";}
        else if (d.win > 0.5){
          return "link";}
        else{
          return "linkWeak"
        }
        ; })


  node = node
    .data(graph.nodes)
    .enter().append("image")
    .attr("class", "node")
    .attr("xlink:href", function(d) { return "http://res.cloudinary.com/dtw89d7fd/image/upload/c_scale,r_30,w_30/v1516037660/"+d.url+".png"; })
    .on('click',function(x) {
    // Ignore events based on dragging.

    if (d3.event.defaultPrevented) return;
    var notes = d3.select('#notes');
    notes
    .style({
        'width': 620-width + 'px',
        'height': height + 'px'
    });
    var selected = x.selected;
    if (!selected) {
        notes.selectAll('*').remove();
        notes.style({'opacity': 0});
        notes.append('h1').text("Nome: " + x.id);
        notes.append('h2').text("Usado: "+ x.value + " vezes.");
        notes.append('img').attr("src","http://ddragon.leagueoflegends.com/cdn/img/champion/loading/"+x.id+"_0.jpg");
        notes.style({'opacity': 1});
    }

    // Toggle the selection state for the node.

    x.selected = !selected;
})  
    .attr("x", function(d) { return -(((d.value/d.value_maximo)+0.5)*20); })
    .attr("y", function(d) { return -(((d.value/d.value_maximo)+0.5)*20); })
    .attr("width", function(d) { return (((d.value/d.value_maximo)+0.5)*40); })
    .attr("height", function(d) { return (((d.value/d.value_maximo)+0.5)*40); })
    .call(d3.drag()
          .on("start", dragstarted)
          .on("drag", dragged)
          .on("end", dragended));
  node.each(function(x){

    // For this pass we want to find all adjacencies.
    // An adjacent node shares an edge with the
    // current node.


    
      });
function ticked() {
  link.attr("x1", function(d) { return d.source.x; })
      .attr("y1", function(d) { return d.source.y; })
      .attr("x2", function(d) { return d.target.x; })
      .attr("y2", function(d) { return d.target.y; });

  node.attr("cx", function(d) { return d.x; })
      .attr("cy", function(d) { return d.y; });
      node.attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });
}
function dragstarted(d) {
  if (!d3.event.active) simulation.alphaTarget(0.3).restart();
  d.fx = d.x;
  d.fy = d.y;
}

function dragged(d) {
  d.fx = d3.event.x;
  d.fy = d3.event.y;
}

function dragended(d) {
  if (!d3.event.active) simulation.alphaTarget(0);
  d.fx = null;
  d.fy = null;
} 

</script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
</body>